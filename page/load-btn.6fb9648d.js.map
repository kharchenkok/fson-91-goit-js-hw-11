{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,iEASA,MAAMC,EAAO,CACXC,SAAUC,SAASC,eAAe,eAClCC,QAASF,SAASC,eAAe,WACjCE,YAAaH,SAASI,cAAc,iBACpCC,MAAOL,SAASC,eAAe,aAC/BK,aAAcN,SAASI,cAAc,kBAGvC,IAAIG,EAAO,EAGX,IAAIC,EAAW,IAAIC,EAAAb,GAAJ,CAAmB,aAAc,CAC9Cc,aAAc,MACdC,aAAc,IACdC,aAAc,mBACdC,eAAgB,GAChBC,UAAW,MAGbhB,EAAKC,SAASgB,iBAAiB,UAS/B,SAAkBC,GAChBA,EAAMC,kBACN,EAAAC,EAAAC,aAAYrB,EAAKI,QAASJ,EAAKK,aAC/B,MAAMiB,EAAQJ,EAAMK,cAAcC,SAASC,YAAYC,MAAMC,OAC7D,IAAKL,GAAmB,MAAVA,EAEZ,YADA,EAAAM,EAAAC,cAAa,QAGfpB,EAAO,GACP,EAAAqB,EAAAC,aAAYT,EAAOb,EA5BL,IA6BXuB,MAAKC,IACJjC,EAAKI,QAAQ8B,mBACX,aACA,EAAAd,EAAAe,kBAAiBF,EAAOG,OAE1BH,EAAOI,UAAY,GAAKJ,EAAOG,KAAKE,OAAS,GACzC,EAAAV,EAAAC,cAAa,UAAWI,EAAOI,YAC/B,EAAAT,EAAAC,cAAa,uBAEbI,EAAOI,UAtCD,IAsCwBJ,EAAOG,KAAKE,OAAS,GACrDtC,EAAKK,YAAYkC,UAAUC,QAAQ,YAAa,aAElD9B,EAAS+B,SAAS,IAEnBC,OAAMC,IACLC,QAAQD,MAAM,0BAA8CA,IACzC,EAAnBf,EAAAC,cAAa,kBAAkB,G,IAlCrC7B,EAAKK,YAAYY,iBAAiB,SAsClC,UAAoB4B,OAAEA,IACpBpC,GAAQ,EACRoC,EAAOC,UAAW,EAClB,MAAMxB,EAAQtB,EAAKC,SAASuB,SAASC,YAAYC,MAAMC,OACjDoB,EAAa/C,EAAKI,QAAQ4C,kBAChC,IAAKD,EACH,QAGF,EAAAjB,EAAAC,aAAYT,EAAOb,EA1DL,IA2DXuB,MAAKC,IACJjC,EAAKI,QAAQ8B,mBACX,aACA,EAAAd,EAAAe,kBAAiBF,EAAOG,OAE1B,MAAQa,OAAQC,GAAeH,EAAWI,wBAE1CzC,EAAS+B,WACT,EAAAW,EAAAC,UAASH,GAELjB,EAAOI,UArED,GAqEa5B,GAAkB,IACvCT,EAAKK,YAAYkC,UAAUC,QAAQ,YAAa,cAChD,EAAAc,EAAAC,yBAAuB,MACrB,EAAA3B,EAAAC,cAAa,mBAAmB,GAC/B7B,EAAKI,QAAQoD,kB,IAGnBd,OAAMC,IACLC,QAAQD,MAAM,0BAA2BA,IACzC,EAAAf,EAAAC,cAAa,kBAAkB,IAEhC4B,SAAQ,KACPZ,EAAOC,UAAW,CAAK,G,IArE7B9C,EAAKO,MAAMU,iBAAiB,QAASmC,EAAAM,UACrCC,OAAO1C,iBAAiB,UAAU,KAChC,EAAAmC,EAAAQ,qBAAoB5D,EAAKQ,aAAcR,EAAKO,UAG9C,EAAAa,EAAAC,aAAYrB,EAAKI,QAASJ,EAAKK","sources":["src/load-btn.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabayApi';\nimport { clearMarkup, createCardMarkup } from './js/markupHelpers';\nimport { createNotify } from './js/notifyHelpers';\nimport { handleScrollEffects, scrollBy, scrollUp } from './js/scroll';\nimport { createLoadMoreObserver } from './js/observers';\n\nconst refs = {\n  userForm: document.getElementById('search-form'),\n  gallery: document.getElementById('gallery'),\n  loadMoreBtn: document.querySelector('.js-load-more'),\n  upBtn: document.getElementById('button-up'),\n  fixedWrapper: document.querySelector('.form-wrapper'),\n};\n\nlet page = 1;\nconst perPage = 40;\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionClass: 'gallery__caption',\n  overlayOpacity: 0.9,\n  fadeSpeed: 350,\n});\n\nrefs.userForm.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\nrefs.upBtn.addEventListener('click', scrollUp);\nwindow.addEventListener('scroll', () =>\n  handleScrollEffects(refs.fixedWrapper, refs.upBtn)\n);\n\nclearMarkup(refs.gallery, refs.loadMoreBtn);\n\nfunction onSearch(event) {\n  event.preventDefault();\n  clearMarkup(refs.gallery, refs.loadMoreBtn);\n  const query = event.currentTarget.elements.searchQuery.value.trim();\n  if (!query || query === ' ') {\n    createNotify('info');\n    return;\n  }\n  page = 1;\n  fetchImages(query, page, perPage)\n    .then(images => {\n      refs.gallery.insertAdjacentHTML(\n        'beforeend',\n        createCardMarkup(images.hits)\n      );\n      images.totalHits > 0 && images.hits.length > 0\n        ? createNotify('success', images.totalHits)\n        : createNotify('failure-no-matching');\n\n      if (images.totalHits > perPage && images.hits.length > 0) {\n        refs.loadMoreBtn.classList.replace('is-hidden', 'load-more');\n      }\n      lightbox.refresh();\n    })\n    .catch(error => {\n      console.error('Помилка під час запиту:', error);\n      createNotify('failure-general');\n    });\n}\n\nfunction onLoadMore({ target }) {\n  page += 1;\n  target.disabled = true;\n  const query = refs.userForm.elements.searchQuery.value.trim();\n  const firstChild = refs.gallery.firstElementChild;\n  if (!firstChild) {\n    return;\n  }\n\n  fetchImages(query, page, perPage)\n    .then(images => {\n      refs.gallery.insertAdjacentHTML(\n        'beforeend',\n        createCardMarkup(images.hits)\n      );\n      const { height: cardHeight } = firstChild.getBoundingClientRect();\n\n      lightbox.refresh();\n      scrollBy(cardHeight);\n\n      if (images.totalHits - page * perPage <= 0) {\n        refs.loadMoreBtn.classList.replace('load-more', 'is-hidden');\n        createLoadMoreObserver(() => {\n          createNotify('info-end-results');\n        }, refs.gallery.lastElementChild);\n      }\n    })\n    .catch(error => {\n      console.error('Помилка під час запиту:', error);\n      createNotify('failure-general');\n    })\n    .finally(() => {\n      target.disabled = false;\n    });\n}\n"],"names":["$fZKcF","parcelRequire","$9e999aa8f3d1c36a$var$refs","userForm","document","getElementById","gallery","loadMoreBtn","querySelector","upBtn","fixedWrapper","$9e999aa8f3d1c36a$var$page","$9e999aa8f3d1c36a$var$lightbox","$parcel$interopDefault","captionsData","captionDelay","captionClass","overlayOpacity","fadeSpeed","addEventListener","event","preventDefault","$7BhbO","clearMarkup","query","currentTarget","elements","searchQuery","value","trim","$fXaWX","createNotify","$eHvix","fetchImages","then","images","insertAdjacentHTML","createCardMarkup","hits","totalHits","length","classList","replace","refresh","catch","error","console","target","disabled","firstChild","firstElementChild","height","cardHeight","getBoundingClientRect","$2YGUk","scrollBy","$j7BGE","createLoadMoreObserver","lastElementChild","finally","scrollUp","window","handleScrollEffects"],"version":3,"file":"load-btn.6fb9648d.js.map"}