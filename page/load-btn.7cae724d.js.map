{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAUMC,EAAO,CACXC,SAAUC,SAASC,eAAe,eAClCC,QAASF,SAASC,eAAe,WACjCE,YAAaH,SAASI,cAAc,iBACpCC,MAAOL,SAASC,eAAe,aAC/BK,aAAcN,SAASI,cAAc,kBAGnCG,EAAO,EAGPC,EAAW,IAAIC,EAAAb,GAAJ,CAAmB,aAAc,CAC9Cc,aAAc,MACdC,aAAc,IACdC,aAAc,mBACdC,eAAgB,GAChBC,UAAW,MAGbhB,EAAKC,SAASgB,iBAAiB,UAS/B,SAAkBC,GAChBA,EAAMC,iBACN,IAAMC,EAAQF,EAAMG,cAAcC,SAASC,YAAYC,MAEvD,IADA,EAAAC,EAAAC,aAAY1B,EAAKI,QAASJ,EAAKK,cAC1Be,GAAmB,MAAVA,EAEZ,YADA,EAAAO,EAAAC,cAAa,QAGfnB,EAAO,GACP,EAAAoB,EAAAC,aAAYV,EAAOX,EA5BL,IA6BXsB,MAAK,SAAAC,GACJhC,EAAKI,QAAQ6B,mBACX,aACA,EAAAR,EAAAS,kBAAiBF,EAAOG,OAE1BH,EAAOI,UAAY,GAAKJ,EAAOG,KAAKE,OAAS,GACzC,EAAAV,EAAAC,cAAa,UAAWI,EAAOI,YAC/B,EAAAT,EAAAC,cAAa,uBAEbI,EAAOI,UAtCD,IAsCwBJ,EAAOG,KAAKE,OAAS,GACrDrC,EAAKK,YAAYiC,UAAUC,QAAQ,YAAa,aAElD7B,EAAS8B,S,IAEVC,OAAM,SAAAC,GACLC,QAAQD,MAAM,0BAA8CA,IACzC,EAAnBf,EAAAC,cAAa,kB,OAlCnB5B,EAAKK,YAAYY,iBAAiB,SAsClC,SAAoB2B,G,IAAAC,EAAAD,EAAEC,OACpBpC,GAAQ,EACRoC,EAAOC,UAAW,EAClB,IAAM1B,EAAQpB,EAAKC,SAASqB,SAASC,YAAYC,MAC3CuB,EAAa/C,EAAKI,QAAQ4C,kBAChC,IAAKD,EACH,QAGF,EAAAlB,EAAAC,aAAYV,EAAOX,EA1DL,IA2DXsB,MAAK,SAAAC,GACJhC,EAAKI,QAAQ6B,mBACX,aACA,EAAAR,EAAAS,kBAAiBF,EAAOG,OAE1B,IAAQc,EAAuBF,EAAWG,wBAAlCC,OAERzC,EAAS8B,WACT,EAAAY,EAAAC,UAASJ,GAELjB,EAAOI,UArED,GAqEa3B,GAAkB,IACvCT,EAAKK,YAAYiC,UAAUC,QAAQ,YAAa,cAEhD,EAAAe,EAAAC,yBAAuB,YACrB,EAAA5B,EAAAC,cAAa,mB,GACZ5B,EAAKI,QAAQoD,kB,IAGnBf,OAAM,SAAAC,GACLC,QAAQD,MAAM,0BAA2BA,IACzC,EAAAf,EAAAC,cAAa,kB,IAEd6B,SAAQ,WACPZ,EAAOC,UAAW,C,OAtExB9C,EAAKO,MAAMU,iBAAiB,QAASmC,EAAAM,UACrCC,OAAO1C,iBAAiB,UAAU,W,OAChC,EAAAmC,EAAAQ,qBAAoB5D,EAAKQ,aAAcR,EAAKO,M,KAG9C,EAAAkB,EAAAC,aAAY1B,EAAKI,QAASJ,EAAKK,Y","sources":["src/load-btn.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabayApi';\nimport { clearMarkup, createCardMarkup } from './js/markupHelpers';\n\nimport { handleScrollEffects, scrollBy, scrollUp } from './js/scroll';\nimport { createNotify } from './js/notifyHelpers';\nimport { createLoadMoreObserver } from './js/observers';\n\nconst refs = {\n  userForm: document.getElementById('search-form'),\n  gallery: document.getElementById('gallery'),\n  loadMoreBtn: document.querySelector('.js-load-more'),\n  upBtn: document.getElementById('button-up'),\n  fixedWrapper: document.querySelector('.form-wrapper'),\n};\n\nlet page = 1;\nconst perPage = 40;\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionClass: 'gallery__caption',\n  overlayOpacity: 0.9,\n  fadeSpeed: 350,\n});\n\nrefs.userForm.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\nrefs.upBtn.addEventListener('click', scrollUp);\nwindow.addEventListener('scroll', () =>\n  handleScrollEffects(refs.fixedWrapper, refs.upBtn)\n);\n\nclearMarkup(refs.gallery, refs.loadMoreBtn);\n\nfunction onSearch(event) {\n  event.preventDefault();\n  const query = event.currentTarget.elements.searchQuery.value;\n  clearMarkup(refs.gallery, refs.loadMoreBtn);\n  if (!query || query === ' ') {\n    createNotify('info');\n    return;\n  }\n  page = 1;\n  fetchImages(query, page, perPage)\n    .then(images => {\n      refs.gallery.insertAdjacentHTML(\n        'beforeend',\n        createCardMarkup(images.hits)\n      );\n      images.totalHits > 0 && images.hits.length > 0\n        ? createNotify('success', images.totalHits)\n        : createNotify('failure-no-matching');\n\n      if (images.totalHits > perPage && images.hits.length > 0) {\n        refs.loadMoreBtn.classList.replace('is-hidden', 'load-more');\n      }\n      lightbox.refresh();\n    })\n    .catch(error => {\n      console.error('Помилка під час запиту:', error);\n      createNotify('failure-general');\n    });\n}\n\nfunction onLoadMore({ target }) {\n  page += 1;\n  target.disabled = true;\n  const query = refs.userForm.elements.searchQuery.value;\n  const firstChild = refs.gallery.firstElementChild;\n  if (!firstChild) {\n    return;\n  }\n\n  fetchImages(query, page, perPage)\n    .then(images => {\n      refs.gallery.insertAdjacentHTML(\n        'beforeend',\n        createCardMarkup(images.hits)\n      );\n      const { height: cardHeight } = firstChild.getBoundingClientRect();\n\n      lightbox.refresh();\n      scrollBy(cardHeight);\n\n      if (images.totalHits - page * perPage <= 0) {\n        refs.loadMoreBtn.classList.replace('load-more', 'is-hidden');\n        // createNotify('info-end-results');\n        createLoadMoreObserver(() => {\n          createNotify('info-end-results');\n        }, refs.gallery.lastElementChild);\n      }\n    })\n    .catch(error => {\n      console.error('Помилка під час запиту:', error);\n      createNotify('failure-general');\n    })\n    .finally(() => {\n      target.disabled = false;\n    });\n}\n\n// function toggleScroll() {\n//   const firstScreenHeight = window.innerHeight;\n//\n//   if (window.scrollY > firstScreenHeight) {\n//     refs.fixedWrapper.classList.add('fixed');\n//     refs.upBtn.classList.replace('is-hidden', 'button-up');\n//   } else {\n//     refs.fixedWrapper.classList.remove('fixed');\n//     refs.upBtn.classList.replace('button-up', 'is-hidden');\n//   }\n// }\n//\n// window.addEventListener('scroll', toggleScroll);\n"],"names":["$5IjG7","parcelRequire","$e84f18c435437d4a$var$refs","userForm","document","getElementById","gallery","loadMoreBtn","querySelector","upBtn","fixedWrapper","$e84f18c435437d4a$var$page","$e84f18c435437d4a$var$lightbox","$parcel$interopDefault","captionsData","captionDelay","captionClass","overlayOpacity","fadeSpeed","addEventListener","event","preventDefault","query","currentTarget","elements","searchQuery","value","$9cwlI","clearMarkup","$hYpAF","createNotify","$9GCeT","fetchImages","then","images","insertAdjacentHTML","createCardMarkup","hits","totalHits","length","classList","replace","refresh","catch","error","console","param","target","disabled","firstChild","firstElementChild","cardHeight","getBoundingClientRect","height","$j1Fxp","scrollBy","$cE2Y3","createLoadMoreObserver","lastElementChild","finally","scrollUp","window","handleScrollEffects"],"version":3,"file":"load-btn.7cae724d.js.map"}